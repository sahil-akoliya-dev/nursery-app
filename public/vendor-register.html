<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Become a Vendor - Nursery App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="/assets/js/app.js"></script>
</head>

<body class="bg-earth-100 text-earth-900 antialiased" x-data="vendorRegister()">
    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md shadow-sm transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <div class="flex-shrink-0 flex items-center">
                    <a href="/" class="flex items-center gap-2 group">
                        <div
                            class="w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white group-hover:bg-primary-700 transition-colors">
                            <i data-lucide="leaf" class="w-6 h-6"></i>
                        </div>
                        <span class="font-display font-bold text-2xl text-primary-900">Nursery<span
                                class="text-primary-600">App</span></span>
                    </a>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/" class="text-earth-800 font-medium hover:text-primary-600 transition-colors">Home</a>
                    <a href="/shop" class="text-earth-800 font-medium hover:text-primary-600 transition-colors">Shop</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="pt-32 pb-16 min-h-screen flex items-center justify-center px-4">
        <div class="max-w-2xl w-full bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row">
            <!-- Image Side -->
            <div class="hidden md:block w-1/2 bg-cover bg-center"
                style="background-image: url('https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?w=800&q=80');">
                <div class="h-full w-full bg-black/40 p-12 flex flex-col justify-end text-white">
                    <h2 class="font-display font-bold text-3xl mb-4">Grow Your Business</h2>
                    <p class="text-gray-200">Join our marketplace and reach thousands of plant lovers.</p>
                </div>
            </div>

            <!-- Form Side -->
            <div class="w-full md:w-1/2 p-8 md:p-12">
                <div class="text-center mb-8">
                    <h2 class="font-display font-bold text-2xl text-earth-900">Become a Vendor</h2>
                    <p class="text-gray-500 mt-2">Start selling your plants today.</p>
                </div>

                <form @submit.prevent="submit" class="space-y-5">
                    <!-- Store Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Store Name</label>
                        <div class="relative">
                            <i data-lucide="store"
                                class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"></i>
                            <input type="text" x-model="form.store_name" required
                                class="pl-10 w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all"
                                placeholder="Green Thumb Nursery">
                        </div>
                    </div>

                    <!-- Description -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Store Description</label>
                        <textarea x-model="form.description" required rows="3"
                            class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all"
                            placeholder="Tell us about your nursery..."></textarea>
                    </div>

                    <!-- Error Message -->
                    <div x-show="error" x-transition
                        class="bg-red-50 text-red-600 p-3 rounded-lg text-sm flex items-center gap-2">
                        <i data-lucide="alert-circle" class="w-4 h-4"></i>
                        <span x-text="error"></span>
                    </div>

                    <!-- Success Message -->
                    <div x-show="success" x-transition
                        class="bg-green-50 text-green-600 p-3 rounded-lg text-sm flex items-center gap-2">
                        <i data-lucide="check-circle" class="w-4 h-4"></i>
                        <span>Registration successful! Redirecting...</span>
                    </div>

                    <button type="submit" :disabled="loading"
                        class="w-full bg-primary-600 text-white font-bold py-3 rounded-lg hover:bg-primary-700 transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                        <span x-show="!loading">Register Store</span>
                        <span x-show="loading" class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></span>
                    </button>
                </form>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('vendorRegister', () => ({
                form: {
                    store_name: '',
                    description: ''
                },
                loading: false,
                error: null,
                success: false,

                async submit() {
                    this.loading = true;
                    this.error = null;

                    try {
                        // Ensure user is logged in
                        const token = localStorage.getItem('auth_token');
                        if (!token) {
                            window.location.href = '/login?redirect=/vendor/register';
                            return;
                        }

                        const response = await axios.post('/api/vendor/register', this.form, {
                            headers: { Authorization: `Bearer ${token}` }
                        });

                        if (response.data.success) {
                            this.success = true;
                            // Update user role in store if needed
                            setTimeout(() => {
                                window.location.href = '/vendor-dashboard';
                            }, 1500);
                        }
                    } catch (err) {
                        this.error = err.response?.data?.message || 'Registration failed. Please try again.';
                    } finally {
                        this.loading = false;
                    }
                }
            }));
            lucide.createIcons();
        });
    </script>
    <div id="toast-placeholder"></div>
</body>

</html>